# SAP Analysis Scripts - Claude Code Generated

A collection of Python scripts for SAP data analysis and reporting, generated by Claude Code using reusable utility libraries.

## Concept

This repository demonstrates how **Claude Code** can generate specialized Python scripts for SAP analysis tasks by leveraging a generic utility library. Each script addresses a specific SAP business need while reusing common functionality for Excel formatting, data processing, and reporting.

### How It Works

1. **Generic Library** (`excel_utils.py`) - Reusable utilities for Excel report generation
2. **Specialized Scripts** - Claude Code creates purpose-specific scripts using the library
3. **SAP Use Cases** - Each script solves a real SAP analysis challenge

## Repository Structure

```
excel_utils.py              # Generic Excel utility library (reusable)
pe_error_analysis.py        # Posting Engine error analysis script
README.md                   # Documentation
```

## Generic Library: excel_utils.py

**Purpose:** Reusable Excel report builder for consistent, professional SAP reports

**Key Features:**
- `ExcelReportBuilder` - Main class for creating formatted Excel workbooks
- `SeverityColorScheme` - Pre-defined color schemes for severity levels
- Helper functions for timestamps, borders, formatting

**Usage Example:**
```python
from excel_utils import ExcelReportBuilder, SeverityColorScheme

# Create a new report
report = ExcelReportBuilder(
    title="My SAP Analysis Report",
    subtitle=f"Generated: {datetime.now()}"
)

# Add headers and data
report.add_title()
report.add_subtitle()
report.add_headers([('A', 'Column 1', 15), ('B', 'Column 2', 30)])
report.add_data_rows(data, {'A': 'field1', 'B': 'field2'})

# Save
report.save('output.xlsx')
```

## Scripts

### 1. pe_error_analysis.py - Posting Engine Error Analysis

**Purpose:** Analyzes common SAP Posting Engine (DMLT) errors and generates actionable Excel reports

**What It Does:**
- Analyzes 10 most common PE errors from SAP migration projects
- Provides root cause analysis and step-by-step solutions
- Creates summary sheet with prioritized remediation plan
- Color-coded severity levels (High/Medium/Low)

**Output:**
- `PE_Error_Analysis_ZFI_SDT.xlsx` - Two-sheet workbook
  - Sheet 1: Detailed error analysis with solutions
  - Sheet 2: Summary with priority order

**Common Errors Analyzed:**
- NR 751 - Number range intervals missing (9999+ occurrences)
- CNV_PE 451 - Transformation rule failures (2328 occurrences)
- CNV_OT_CX 000 - Generic exceptions (1746 occurrences)
- F5A 002/003 - Master data deletion flags
- CNV_PE 205 - Reference document dependencies
- CNV_PE 589 - WL2 modification rule errors
- F5 351/026 - Account blocks and bank details
- /SLO/PECON 102 - Withholding tax data issues

**Usage:**
```bash
python pe_error_analysis.py
```

**SAP Context:**
- **System:** MWA / Client: 100
- **Project:** ZFI_SDT
- **Area:** ZAP_OI (Vendor Open Items)
- **Scenario:** Receiver Processing
- **Transactions:** /SLO/PECON, CNV_PE_PROJ, CNV_PE_EDITOR

---

## Setup & Prerequisites

### Python Requirements
```bash
# Install required library
pip install openpyxl
```

### Python Version
- Python 3.x (tested with Python 3.14.0)

## Running Scripts

```bash
# Run Posting Engine error analysis
python pe_error_analysis.py
```

## Adding New Scripts

Claude Code can generate new scripts for other SAP analysis needs by:

1. Using the `excel_utils.py` library for consistent reporting
2. Implementing specific business logic for the analysis
3. Following the same pattern: data → processing → Excel output

**Example Use Cases:**
- FI/CO document analysis
- Master data validation reports
- Migration readiness assessments
- System comparison reports
- Error pattern analysis for any SAP module

## SAP Knowledge Base

### Posting Engine (DMLT /SLO/PECON)

**Purpose:** Migrate FI/CO open items and balances between SAP systems

**Key Transactions:**
- `/SLO/PECON` - Main Posting Engine entry point
- `CNV_PE_PROJ` - Project maintenance
- `CNV_PE_EDITOR` - Transfer method configuration

**Common Tables:**
- `BSIK` - Vendor open items
- `BSID` - Customer open items
- `BSIS` - G/L account open items

## Benefits of This Approach

✅ **Reusability** - Generic library used across multiple scripts
✅ **Consistency** - All reports follow the same professional formatting
✅ **Maintainability** - Update library once, all scripts benefit
✅ **Scalability** - Easy to add new analysis scripts
✅ **AI-Generated** - Claude Code creates scripts tailored to specific needs

## Contributing

This repository demonstrates Claude Code's ability to generate SAP analysis scripts. Fork and adapt for your own SAP analysis needs.

## License

Internal use - SAP proprietary knowledge and tools required.

## Author

Generated with **Claude Code** by Anthropic
Maintained by: Herbert Fromm (herbert.fromm@sap.com)
