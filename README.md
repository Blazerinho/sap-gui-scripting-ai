# SAP Analysis Scripts - Claude Code Generated

A collection of Python scripts for SAP data analysis and reporting, generated by Claude Code using reusable utility libraries.


## Concept

This repository demonstrates how **Claude Code** can generate specialized Python scripts for SAP analysis tasks by leveraging a generic utility library. Each script addresses a specific SAP business need while reusing common functionality for Excel formatting, data processing, and reporting.

## Setup & Prerequisites

### 1. Claude Code Installation

**Claude Code** is required to generate new SAP analysis scripts using natural language.

#### Installation Steps:

**Option A: Using npm (Recommended)**
```bash
npm install -g @anthropic-ai/claude-code
```

**Option B: Using pip**
```bash
pip install claude-code
```

**Option C: Download Binary**
- Visit: https://claude.ai/download
- Download the installer for your OS (Windows/macOS/Linux)
- Follow installation instructions

#### Authentication:
```bash
# Login to Claude Code
claude auth login

# Verify installation
claude --version
```

### 2. SAP GUI Scripting Setup

**SAP GUI Scripting** is the interface to connect to and automate SAP systems via COM automation.

**Note:** The example script `pe_error_analysis.py` uses hardcoded error data for demonstration purposes and doesn't require a live SAP connection. However, to create scripts that extract real data from SAP, you **must** have SAP GUI Scripting enabled.

#### Prerequisites:
- **Windows OS** (SAP GUI Scripting uses COM automation)
- **SAP GUI for Windows** installed
- **Access to SAP system** with appropriate authorizations

#### Enable SAP GUI Scripting:

**Client-Side (Your PC):**
1. Open SAP Logon
2. Press `Alt + F12` to open SAP GUI Options
3. Navigate to: **Accessibility & Scripting → Scripting**
4. Check: ✅ **Enable scripting**
5. Click **OK**

**Server-Side (SAP System):**
The SAP administrator must enable scripting via transaction `RZ11`:
```
Parameter: sapgui/user_scripting
Value: TRUE
```

#### Python Library for SAP GUI Automation:
Required for all SAP data extraction scripts:
```bash
pip install pywin32
```

**Example SAP GUI Connection:**
```python
import win32com.client

# Connect to SAP GUI
sap_gui = win32com.client.GetObject("SAPGUI")
application = sap_gui.GetScriptingEngine
connection = application.Children(0)  # First connection
session = connection.Children(0)      # First session

# Now you can interact with SAP
# Example: Navigate to transaction
session.StartTransaction("SE16")
```

### 3. Python Requirements

**Python Version:**
- Python 3.x (tested with Python 3.14.0)
- Recommended: Python 3.8 or higher

**Install Required Libraries:**
```bash
# For Excel report generation (required for excel output)
pip install openpyxl

# For SAP GUI automation and data extraction (required for SAP connectivity)
pip install pywin32
```

**Create Virtual Environment (Recommended):**
```bash
# Create virtual environment
python -m venv venv

# Activate (Windows)
venv\Scripts\activate

# Activate (macOS/Linux)
source venv/bin/activate

# Install all dependencies
pip install pywin32
```

## How Claude Code get into SAP GUI and act like you

Claude Code can generate new SAP analysis scripts tailored to your specific needs. Here's how:

### Step-by-Step Guide:

1. **Start Claude Code in your project directory:**
   ```bash
   cd sap_gui_scripting_ai
   claude
   ```

2.**Let Claude learn to generate a python script based on** 
https://help.sap.com/doc/9215986e54174174854b0af6bb14305a/770.08/en-US/sap_gui_scripting_api.pdf

3. **Fed Claude with your specific knowledge**
   
4.  **Ask Claude to do your work**

   **Example Prompts:**
    "Go into Error Monitor of /SLO/PECON, check messages, create Excel with solutions"

5. **Claude Code will:**
   - Import and use the `excel_utils.py` library
   - Implement your specific business logic
   - Generate a properly formatted Excel report
   - Follow the established pattern and coding style

6. **Test and refine:**
   ```bash
   python your_new_script.py
   ```

### Best Practices:

- start with short processes
- and start combined more and more processes

### Example Use Cases:

Any process within SAP GUI.

**Migration Projects:**
- Error analysis including solution proposal



## SAP Knowledge Base

SAP GUI Script API descripition https://help.sap.com/doc/9215986e54174174854b0af6bb14305a/770.08/en-US/sap_gui_scripting_api.pdf

## Benefits of This Approach

✅ **Reusability** - Generic library used across multiple scripts
✅ **Consistency** - All reports follow the same professional formatting
✅ **Maintainability** - Update library once, all scripts benefit
✅ **Scalability** - Easy to add new analysis scripts
✅ **AI-Generated** - Claude Code creates scripts tailored to specific needs

## Contributing

This repository demonstrates Claude Code's ability to generate SAP python scripts.


