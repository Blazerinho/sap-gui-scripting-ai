# SAP Analysis Scripts - Claude Code Generated

A collection of Python scripts for SAP data analysis and reporting, generated by Claude Code using reusable utility libraries.

## Quick Start

```bash
# 1. Clone the repository
git clone https://github.com/Blazerinho/sap-gui-scripting-ai.git
cd sap-gui-scripting-ai

# 2. Install dependencies
pip install openpyxl

# 3. Run the Posting Engine error analysis
python pe_error_analysis.py

# 4. (Optional) Install Claude Code to generate new scripts
npm install -g @anthropic-ai/claude-code
claude auth login
```

## Concept

This repository demonstrates how **Claude Code** can generate specialized Python scripts for SAP analysis tasks by leveraging a generic utility library. Each script addresses a specific SAP business need while reusing common functionality for Excel formatting, data processing, and reporting.

### How It Works

1. **Generic Library** (`excel_utils.py`) - Reusable utilities for Excel report generation
2. **Specialized Scripts** - Claude Code creates purpose-specific scripts using the library
3. **SAP Use Cases** - Each script solves a real SAP analysis challenge

## Repository Structure

```
excel_utils.py              # Generic Excel utility library (reusable)
pe_error_analysis.py        # Posting Engine error analysis script
README.md                   # Documentation
```

## Generic Library: excel_utils.py

**Purpose:** Reusable Excel report builder for consistent, professional SAP reports

**Key Features:**
- `ExcelReportBuilder` - Main class for creating formatted Excel workbooks
- `SeverityColorScheme` - Pre-defined color schemes for severity levels
- Helper functions for timestamps, borders, formatting

**Usage Example:**
```python
from excel_utils import ExcelReportBuilder, SeverityColorScheme

# Create a new report
report = ExcelReportBuilder(
    title="My SAP Analysis Report",
    subtitle=f"Generated: {datetime.now()}"
)

# Add headers and data
report.add_title()
report.add_subtitle()
report.add_headers([('A', 'Column 1', 15), ('B', 'Column 2', 30)])
report.add_data_rows(data, {'A': 'field1', 'B': 'field2'})

# Save
report.save('output.xlsx')
```

## Scripts

### 1. pe_error_analysis.py - Posting Engine Error Analysis

**Purpose:** Analyzes common SAP Posting Engine (DMLT) errors and generates actionable Excel reports

**What It Does:**
- Analyzes 10 most common PE errors from SAP migration projects
- Provides root cause analysis and step-by-step solutions
- Creates summary sheet with prioritized remediation plan
- Color-coded severity levels (High/Medium/Low)

**Output:**
- `PE_Error_Analysis.xlsx` - Two-sheet workbook
  - Sheet 1: Detailed error analysis with solutions
  - Sheet 2: Summary with priority order

**Common Errors Analyzed:**
- NR 751 - Number range intervals missing (9999+ occurrences)
- CNV_PE 451 - Transformation rule failures (2328 occurrences)
- CNV_OT_CX 000 - Generic exceptions (1746 occurrences)
- F5A 002/003 - Master data deletion flags
- CNV_PE 205 - Reference document dependencies
- CNV_PE 589 - WL2 modification rule errors
- F5 351/026 - Account blocks and bank details
- /SLO/PECON 102 - Withholding tax data issues

**Usage:**
```bash
python pe_error_analysis.py
```

**SAP Context:**
- **Area:** Vendor Open Items
- **Scenario:** Receiver Processing
- **Transactions:** /SLO/PECON, CNV_PE_PROJ, CNV_PE_EDITOR

---

## Setup & Prerequisites

### 1. Claude Code Installation

**Claude Code** is required to generate new SAP analysis scripts using natural language.

#### Installation Steps:

**Option A: Using npm (Recommended)**
```bash
npm install -g @anthropic-ai/claude-code
```

**Option B: Using pip**
```bash
pip install claude-code
```

**Option C: Download Binary**
- Visit: https://claude.ai/download
- Download the installer for your OS (Windows/macOS/Linux)
- Follow installation instructions

#### Authentication:
```bash
# Login to Claude Code
claude auth login

# Verify installation
claude --version
```

#### Usage for Script Generation:
Once installed, you can use Claude Code to generate new SAP analysis scripts:
```bash
# Start Claude Code in your project directory
cd sap_gui_scripting_ai
claude

# Then ask Claude to generate scripts, e.g.:
# "Create a script to analyze FI document posting errors using excel_utils.py"
# "Generate a master data validation report for vendor accounts"
```

### 2. SAP GUI Scripting Setup (Optional)

**Note:** SAP GUI Scripting is only needed if you plan to automate SAP transactions. For standalone analysis scripts like `pe_error_analysis.py`, this is **not required**.

#### Prerequisites:
- **Windows OS** (SAP GUI Scripting uses COM automation)
- **SAP GUI for Windows** installed

#### Enable SAP GUI Scripting:

**Client-Side (Your PC):**
1. Open SAP Logon
2. Press `Alt + F12` to open SAP GUI Options
3. Navigate to: **Accessibility & Scripting → Scripting**
4. Check: ✅ **Enable scripting**
5. Click **OK**

**Server-Side (SAP System):**
The SAP administrator must enable scripting via transaction `RZ11`:
```
Parameter: sapgui/user_scripting
Value: TRUE
```

#### Python Library for SAP GUI Automation:
If you plan to create SAP GUI automation scripts:
```bash
pip install pywin32
```

### 3. Python Requirements

**Python Version:**
- Python 3.x (tested with Python 3.14.0)
- Recommended: Python 3.8 or higher

**Install Required Libraries:**
```bash
# For Excel report generation (required)
pip install openpyxl

# For SAP GUI automation (optional - only if automating SAP transactions)
pip install pywin32
```

**Create Virtual Environment (Recommended):**
```bash
# Create virtual environment
python -m venv venv

# Activate (Windows)
venv\Scripts\activate

# Activate (macOS/Linux)
source venv/bin/activate

# Install dependencies
pip install openpyxl
```

## Running Scripts

```bash
# Run Posting Engine error analysis
python pe_error_analysis.py
```

## How to Generate New Scripts with Claude Code

Claude Code can generate new SAP analysis scripts tailored to your specific needs. Here's how:

### Step-by-Step Guide:

1. **Start Claude Code in your project directory:**
   ```bash
   cd sap_gui_scripting_ai
   claude
   ```

2. **Ask Claude to generate a script using the generic library:**

   **Example Prompts:**
   ```
   "Create a script to analyze FI/CO document posting errors
    using excel_utils.py. Include error counts, root causes,
    and solutions in a formatted Excel report."

   "Generate a master data validation report for customer
    accounts (KNA1/KNB1) with duplicate checks and data
    quality issues."

   "Build a migration readiness assessment script that
    analyzes open items and identifies potential posting
    blockers."
   ```

3. **Claude Code will:**
   - Import and use the `excel_utils.py` library
   - Implement your specific business logic
   - Generate a properly formatted Excel report
   - Follow the established pattern and coding style

4. **Test and refine:**
   ```bash
   python your_new_script.py
   ```

### Best Practices:

✅ **Be specific** about what data to analyze and what output you need
✅ **Reference `excel_utils.py`** to ensure Claude uses the generic library
✅ **Provide sample data structure** if available (table names, fields, etc.)
✅ **Mention severity levels** if you want color-coded outputs
✅ **Ask for documentation** - Claude can add docstrings and comments

### Example Use Cases:

**Financial Analysis:**
- FI/CO document analysis
- Clearing differences report
- Payment run error analysis
- Tax code validation

**Master Data:**
- Master data validation reports
- Duplicate detection (vendors, customers, materials)
- Incomplete master records
- Deletion flag analysis

**Migration Projects:**
- Migration readiness assessments
- Data quality reports
- System comparison reports
- Error pattern analysis for any SAP module

**Custom Analysis:**
- Table comparison reports
- Configuration validation
- User access analysis
- Workflow error reports

## SAP Knowledge Base

### Posting Engine (DMLT /SLO/PECON)

**Purpose:** Migrate FI/CO open items and balances between SAP systems

**Key Transactions:**
- `/SLO/PECON` - Main Posting Engine entry point
- `CNV_PE_PROJ` - Project maintenance
- `CNV_PE_EDITOR` - Transfer method configuration

**Common Tables:**
- `BSIK` - Vendor open items
- `BSID` - Customer open items
- `BSIS` - G/L account open items

## Benefits of This Approach

✅ **Reusability** - Generic library used across multiple scripts
✅ **Consistency** - All reports follow the same professional formatting
✅ **Maintainability** - Update library once, all scripts benefit
✅ **Scalability** - Easy to add new analysis scripts
✅ **AI-Generated** - Claude Code creates scripts tailored to specific needs

## Contributing

This repository demonstrates Claude Code's ability to generate SAP analysis scripts. Fork and adapt for your own SAP analysis needs.

## License

Internal use - SAP proprietary knowledge and tools required.

## Author

Generated with **Claude Code** by Anthropic
Maintained by: Herbert Fromm (herbert.fromm@sap.com)
